{"PublicRelease": "\u00a92020 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-03607-4", "Techniques": [{"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Detections": [{"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9830.png", "ScreenshotCaption": "20.a.1 - command line from properties from process"}]}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Detections": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-7379.png", "ScreenshotCaption": "3.a.1 - monkey png again"}]}]}, {"SubStep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for malicious PowerShell.  ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9596.png", "ScreenshotCaption": "4.a.1 - we can see sysinternalsuite.zip in the file event from the process tree"}, {"ScreenshotName": "Cybereason-APT29-9594.png", "ScreenshotCaption": "4.a.1 - malicious high integrity powershell"}]}]}, {"SubStep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Detections": [{"DetectionNote": "Telemetry showed a file write event of python.exe. The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9635.png", "ScreenshotCaption": "8.b.1 - copies of each other ^^"}]}]}, {"SubStep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file rar.exe", "Detections": [{"DetectionNote": "Telemetry showed a create file event for python.exe creating rar.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9650.png", "ScreenshotCaption": "9.a.1 and 2 rar.exe and sdeltee64 file vents"}]}]}, {"SubStep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file sdelete64.exe", "Detections": [{"DetectionNote": "Telemetry showed a create file event for python.exe creating sdelete64.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9650.png", "ScreenshotCaption": "9.a.1 and 2 rar.exe and sdeltee64 file vents"}]}]}, {"SubStep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Detections": [{"DetectionNote": "A General alert detection (unique symbol) was generated for using PowerShell to execute suspicious 'download' commands. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9742.png", "ScreenshotCaption": "14.b.3 - alerts list, mimikatz"}]}]}, {"SubStep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Detections": [{"DetectionNote": "Telemetry showed the file write of m.exe to the System32 directory by wsmprovhost.exe. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9790.png", "ScreenshotCaption": "16.d.1 - file event wsmprovhost.exe process tree, process marked as malicious"}]}]}]}, {"TechniqueId": "T1112", "TechniqueName": "Modify Registry", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command\u00a0subkey", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1086", "TechniqueName": "PowerShell", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u00a0spawning from cmd.exe", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe spawning from cmd.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10771.png", "ScreenshotCaption": "MSSP - b1, b2"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-7352.png", "ScreenshotCaption": "1.b.2 - same process tree view (telemetry) showing cmd.exe spawns powershell"}]}]}, {"SubStep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red; unique symbol) for \"Malicious Process powershell.exe\" was generated due to suspicious use of PowerShell. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9597.png", "ScreenshotCaption": "4.a.2 - interactive powershell process details"}, {"ScreenshotName": "Cybereason-APT29-9594.png", "ScreenshotCaption": "4.a.1 - malicious high integrity powershell"}]}]}, {"SubStep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u200b spawning from python.exe", "Detections": [{"DetectionNote": "Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9651.png", "ScreenshotCaption": "9.b.1 - python spawning powershell"}]}]}, {"SubStep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Detections": [{"DetectionNote": "A Technique alert detection (red; unique symbol) called \"ATT&CK Execution: PowerShell\" was generated due to powershell.exe spawned from a PowerShell stager.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9695.png", "ScreenshotCaption": "11.a.12 - powershell iex stager"}, {"ScreenshotName": "Cybereason-APT29-9689.png", "ScreenshotCaption": "11.a.2 - commandline, schemas, etc. from process tree"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9689.png", "ScreenshotCaption": "11.a.2 - commandline, schemas, etc. from process tree"}]}]}, {"SubStep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red, unique symbol) called \"ATT&CK Execution: PowerShell\" was generated due to a SYSTEM-level PowerShell spawned from wmiprvse.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9832.png", "ScreenshotCaption": "20.a.3 - malops and suspicions"}, {"ScreenshotName": "Cybereason-APT29-9834.png", "ScreenshotCaption": "20.a.3 - process details and tree with system "}, {"ScreenshotName": "Cybereason-APT29-9836.png", "ScreenshotCaption": "20.a.3 - system user from evidence"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawned from WMI event subscription (wmiprvse.exe) as SYSTEM.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9834.png", "ScreenshotCaption": "20.a.3 - process details and tree with system "}]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Detections": [{"DetectionNote": "A Tactic alert detection (red icon) called \"ATT&CK: Execution\" was generated due to PSEXESVC.exe attempting to execute a malicious file. The detection was correlated to a parent alert for malicious PowerShell. ", "DetectionType": "Tactic", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9648.png", "ScreenshotCaption": "8.c.3 - process details with the suspicious "}, {"ScreenshotName": "Cybereason-APT29-9647.png", "ScreenshotCaption": "8.c.3 - full proces tree with suspicious for python.exe info"}]}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe. The detection was correlated to a parent alert for malicious PowerShell. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9647.png", "ScreenshotCaption": "8.c.3 - full proces tree with suspicious for python.exe info"}]}]}, {"SubStep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1102", "TechniqueName": "Web Service", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated due to net.exe conducting suspicious activity and connecting to a well known port. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9812.png", "ScreenshotCaption": "18.a.1 - network connection over port 443"}, {"ScreenshotName": "Cybereason-APT29-9807.png", "ScreenshotCaption": "18.a.1 - net process tree"}]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389 and a modload for System.DirectoryServices.dll. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9767.png", "ScreenshotCaption": "16.a.1 - network connection details"}]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam", "Criteria": "Successful logon as user Pam on\u00a0Scranton (10.0.1.4) ", "Detections": [{"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam. The detection was correlated to a parent alert for malicious PowerShell. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9641.png", "ScreenshotCaption": "8.c.1 - process tree for logon session"}]}]}, {"SubStep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4) ", "Detections": [{"DetectionNote": "An MSSP detection for Valid Accounts occurred containing evidence of the Successful logon on NewYork as user MScott.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10803.png", "ScreenshotCaption": "MSSP - mscott logging onto newYork via winRM"}]}, {"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9782.png", "ScreenshotCaption": "16.c.2 - details for 1 logon session"}, {"ScreenshotName": "Cybereason-APT29-9783.png", "ScreenshotCaption": "16.c.2 - user details"}]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process \u200bOR the original filename (cod.3aka.scr)", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) was generated for a payload using the RTLO character to manipulate and obscure the payload's extension.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-7328.png", "ScreenshotCaption": "1.a.2 - fill Alert details for the .scr file"}]}]}, {"SubStep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesscheck.exe is not the legitimate Sysinternals tool", "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for accesschk.exe being an unsigned file with a known signed version. The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9615.png", "ScreenshotCaption": "generic alert for unsigned file with a known signed version"}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-7335.png", "ScreenshotCaption": "1.a.4 - process details showing rc4 encryption"}, {"ScreenshotName": "Cybereason-APT29-7334.png", "ScreenshotCaption": "1.a.3 - process details showing the network connection over port 1234"}]}]}, {"SubStep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed the loading of cryptographic libraries.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed the loading of cryptographic libraries.", "DetectionType": "None", "Modifiers": [], "Footnotes": ["Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so detection does not apply."]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Detections": [{"DetectionNote": "An MSSP detection for \"Invoke-Persistence (persistence via shortcut/run key)\" occurred containing evidence of the  PowerShell creating the hostui.lnk file.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10787.png", "ScreenshotCaption": "MSSP - javamtsup executed/created"}]}, {"DetectionNote": "Telemetry showed the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9610.png", "ScreenshotCaption": "5.b.1 - powershell create the file hostui.lnk"}]}]}, {"SubStep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Detections": [{"DetectionNote": "An MSSP detection for \"Registry Run Keys / Startup Folder\" occurred containing evidence of hostui.lnk executing from Startup Folder.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10781.png", "ScreenshotCaption": "MSSP - b1 - .lnk in startup folder"}]}]}, {"SubStep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Registry key modification (ATT&CK Persistence)\" was generated when the Webcache subkey was added to the Registry Run key. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9696.png", "ScreenshotCaption": "11.a.11 - registry event with more details, machine name, process name"}, {"ScreenshotName": "Cybereason-APT29-9693.png", "ScreenshotCaption": "11.a.11 - registry technique, process tree"}]}]}]}, {"TechniqueId": "T1045", "TechniqueName": "Software Packing", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Detections": [{"DetectionNote": "An MSSP detection for \"Defense Evasion - Software Packing\" showed python.exe was packed.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10780.png", "ScreenshotCaption": "MSSP - b2 - python is packed"}]}]}]}, {"TechniqueId": "T1122", "TechniqueName": "Component Object Model Hijacking", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of\u00a0the DelegateExecute\u00a0\u200bsubkey in\u00a0\u200bHKCU\\Software\\Classes\\Folder\\shell\\open\\\u200b\u200bcommand\u200b\u200b", "Detections": [{"DetectionNote": "An MSSP detection for \"COM Hijacking (T1122)\" occurred containing evidence of the addition of the DelegateExecute Registry Value.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10777.png", "ScreenshotCaption": "MSSP - b1 - reg key"}]}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9902.png", "ScreenshotCaption": "3.b.1 - delegate execute registry entry (cc) "}], "Footnotes": ["For the Configuration Change, the PowerShell detection policy was disabled."]}]}, {"SubStep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red; unique symbol) called \"User Execution\" was generated due to explorer.exe executing rcs.3aka3.doc.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-7330.png", "ScreenshotCaption": "1.a.1 - process tree for user execution"}]}, {"DetectionNote": "A General alert detection was generated for rcs.3aka3.doc being identified as unknown malware.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-7333.png", "ScreenshotCaption": "1.a.1 - timestamp included for user execution alert"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-7333.png", "ScreenshotCaption": "1.a.1 - timestamp included for user execution alert"}, {"ScreenshotName": "Cybereason-APT29-7330.png", "ScreenshotCaption": "1.a.1 - process tree for user execution"}]}]}, {"SubStep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Detections": [{"DetectionNote": "A General alert detection (red indicator) was generated for malicious use of powershell.exe.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9685.png", "ScreenshotCaption": "11.a.1 - process tree spawning powershell, malops"}, {"ScreenshotName": "Cybereason-APT29-9687.png", "ScreenshotCaption": "11.a.1/2 - get-content "}]}, {"DetectionNote": "Telemetry showed explorer.exe spawning powershell.exe.", "DetectionType": "Telemetry", "Modifiers": []}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Detections": [{"DetectionNote": "Telemetry showed the creation of javamtsup service. The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9608.png", "ScreenshotCaption": "5.a.1 - service details on java "}, {"ScreenshotName": "Cybereason-APT29-9606.png", "ScreenshotCaption": "5.a.1 - creation of javamtsup"}]}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe\u00a0spawning from the rcs.3aka3.doc\u200b process", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of cmd.exe spawning from rcs.3aka3.doc\u200b.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10771.png", "ScreenshotCaption": "MSSP - b1, b2"}]}, {"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-7351.png", "ScreenshotCaption": "1.b.1 - payload spawns cmd.exe (process tree) telemetry"}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10792.png", "ScreenshotCaption": "MSSP - API call"}]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9655.png", "ScreenshotCaption": "9.b.6 / 7 powershell executing rar.exe in process tree"}]}]}]}, {"TechniqueId": "T1097", "TechniqueName": "Pass the Ticket", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Detections": [{"DetectionNote": "A General alert detection was generated for attempted credential theft. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9840.png", "ScreenshotCaption": "20.b.1 - malops for powershell and credential theft, command and control"}, {"ScreenshotName": "Cybereason-APT29-13712.png", "ScreenshotCaption": "20b1 - vendor pic - process tree with evidence"}]}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.  The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-7390.png", "ScreenshotCaption": "3.b.3 - connection over port 443 process details"}]}]}, {"SubStep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9723.png", "ScreenshotCaption": "11.a.13 - connection over port 443, process tree"}]}]}]}, {"TechniqueId": "T1028", "TechniqueName": "Windows Remote Management", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Windows Remote Management\" was generated due to the connection to remote host Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9632.png", "ScreenshotCaption": "8.a.2 - powershell and local address with port 5985"}, {"ScreenshotName": "Cybereason-APT29-9633.png", "ScreenshotCaption": "8.a.2 -  see loaded ps"}]}, {"DetectionNote": "An MSSP detection for \"Windows Remote Management\" occurred containing evidence of the connection to remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10779.png", "ScreenshotCaption": "MSSP - a2, winRM"}]}, {"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9632.png", "ScreenshotCaption": "8.a.2 - powershell and local address with port 5985"}]}]}, {"SubStep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Detections": [{"DetectionNote": "An MSSP detection for Windows Remote Management occurred containing evidence of the connection to remote host NewYork (10.0.0.4) over port 5985.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10805.png", "ScreenshotCaption": "MSSP - c1"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9779.png", "ScreenshotCaption": "16.c.1 - port 5985 details from the process tree"}]}]}, {"SubStep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9846.png", "ScreenshotCaption": "20.b.2 process tree with the connection details over port 5985"}, {"ScreenshotName": "Cybereason-APT29-9845.png", "ScreenshotCaption": "20.b.2 - connection details contin"}]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesscheck.exe executing the CryptUnprotectedData API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe\u00a0reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Detections": [{"DetectionNote": "A Technique alert detection (red; unique symbol) called \"Credential Theft\" was generated due to powershell.exe injection into lsass.exe. The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9619.png", "ScreenshotCaption": "evidence behind the process"}, {"ScreenshotName": "Cybereason-APT29-9618.png", "ScreenshotCaption": "alert for powershell credential theft"}]}]}, {"SubStep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Credential Theft\" was generated for command-line arguments indicative of Mimikatz credential dumping and accessing Lsass. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9750.png", "ScreenshotCaption": "14.b.4 - commandline with sekurlsa logonpasswords"}, {"ScreenshotName": "Cybereason-APT29-9751.png", "ScreenshotCaption": "14.b.4 - evidence with process access to lsass"}]}]}, {"SubStep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection (red, unique symbol) called Credential Theft was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9794.png", "ScreenshotCaption": "16.d.2 - command line with the lsadump injection from the process details"}, {"ScreenshotName": "Cybereason-APT29-9795.png", "ScreenshotCaption": "16.d.2 - suspicion highlighted"}]}]}]}, {"TechniqueId": "T1497", "TechniqueName": "Virtualization/Sandbox Evasion", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.4", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed the loading of cryptographic libraries.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.14", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed the loading of cryptographic libraries.", "DetectionType": "None", "Modifiers": [], "Footnotes": ["Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so detection does not apply."]}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe\u00a0executing\u200b Get-WmiObject ...\u200b -Class\u00a0AntiVirusProduct", "Detections": [{"DetectionNote": "An MSSP detection for Security Software Discovery occurred containing evidence of powershell executing Get-WmiObject and -Class AntiVirusProduct.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10786.png", "ScreenshotCaption": "MSSP - invoke-discovery (firewall, antivirus)"}, {"ScreenshotName": "Cybereason-APT29-10790.png", "ScreenshotCaption": "MSSP - c7 - antivirus"}]}]}, {"SubStep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe\u00a0executing Get-WmiObject\u00a0...\u200b\u200b -Class\u00a0FireWallProduct", "Detections": [{"DetectionNote": "An MSSP detection for \"Enumeration Invoke-Discovery\" occurred containing evidence of powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10786.png", "ScreenshotCaption": "MSSP - invoke-discovery (firewall, antivirus)"}]}]}, {"SubStep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetGroups\u00a0API", "Detections": [{"DetectionNote": "An MSSP detection for \"Enumeration Invoke-Discovery\" occurred containing evidence of the NetUserGetGroups API call.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10786.png", "ScreenshotCaption": "MSSP - invoke-discovery (firewall, antivirus)"}, {"ScreenshotName": "Cybereason-APT29-10785.png", "ScreenshotCaption": "MSSP - netusergetgroups (9/10)"}]}]}, {"SubStep": "4.C.11", "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetLocalGroups\u00a0API", "Detections": [{"DetectionNote": "A MSSP detection for \"Invoke-NetUserGetLocalGroups (psreflect)\" occurred containing evidence of the NetUserGetLocalGroups API call.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10783.png", "ScreenshotCaption": "MSSP - c11 - netusergetlocalgroup"}]}]}]}, {"TechniqueId": "T1106", "TechniqueName": "Execution through API", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Detections": [{"DetectionNote": "An MSSP detection for \"Invoke-NetUserGetGroups (psreflect)\" occurred containing evidence of the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10785.png", "ScreenshotCaption": "MSSP - netusergetgroups (9/10)"}]}]}, {"SubStep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Detections": [{"DetectionNote": "A MSSP detection for \"Invoke-NetUserGetLocalGroups (psreflect)\" occurred containing evidence of the NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10783.png", "ScreenshotCaption": "MSSP - c11 - netusergetlocalgroup"}]}]}, {"SubStep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed svchost.exe with -seclogon flag spawning before PowerShell.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9674.png", "ScreenshotCaption": "10.b.2 - creation from svchostexe process "}]}]}, {"SubStep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed that PowerShell loaded Advapi32.dll.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9773.png", "ScreenshotCaption": "16.b.2 - advapi32.dll loaded module from powershell"}]}]}]}, {"TechniqueId": "T1005", "TechniqueName": "Data from Local System", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "An MSSP detection for \"PowerShell activity looking for files in a directory T1005\" occurred containing evidence of a file event for powershell.exe reading files from Pam's system.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10773.png", "ScreenshotCaption": "MSSP - a2 (child item in blue box), a3 (pam file reads)"}, {"ScreenshotName": "Cybereason-APT29-10772.png", "ScreenshotCaption": "MSSP - a5 (draft.zip create)"}]}, {"DetectionNote": "Telemetry showed file opens of C:\\Users\\Pam\\*. The event was correlated to a parent General detection rcs.3aka3.doc being identified as unknown malware.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9887.png", "ScreenshotCaption": "2.a.3 powershell executed process, opened files (cc)"}, {"ScreenshotName": "Cybereason-APT29-9889.png", "ScreenshotCaption": "2.a.3 - files from pams system (cc)"}], "Footnotes": ["A sensor policy update that enables file read event collection was re-applied."]}]}, {"SubStep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Detections": [{"DetectionNote": "Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9966.png", "ScreenshotCaption": " full path sysinternalssuite.zip (cc)"}, {"ScreenshotName": "Cybereason-APT29-9965.png", "ScreenshotCaption": " files from powershell sysinterals (cc) "}], "Footnotes": ["A sensor policy update that enables file read event collection was re-applied."]}]}, {"SubStep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "Telemetry showed file opens of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9973.png", "ScreenshotCaption": "9.b.4 - (cc)"}, {"ScreenshotName": "Cybereason-APT29-9972.png", "ScreenshotCaption": "9.b.4 - process tree (cc)"}], "Footnotes": ["A sensor policy update that enables file read event collection was re-applied."]}]}, {"SubStep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Telemetry showed PowerShell opening MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for malicious use of PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9934.png", "ScreenshotCaption": "17.b.1 - malops 2 processes (cc)"}, {"ScreenshotName": "Cybereason-APT29-9935.png", "ScreenshotCaption": "17.b.1 - full path (cc)"}], "Footnotes": ["A sensor policy update that enables file read event collection was re-applied."]}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav\u00a0network share (192.168.0.4:80)", "Detections": [{"DetectionNote": "Telemetry showed PoweShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9623.png", "ScreenshotCaption": "7.b.2 - office supplies.7z information from events"}]}]}, {"SubStep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Detections": [{"DetectionNote": "A General alert detection (unique symbol) was generated for PowerShell executing a malicious command. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "General", "Modifiers": ["Configuration Change (Detections)", "Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9942.png", "ScreenshotCaption": "18.a.2 - malicious command  Alert (cc)"}, {"ScreenshotName": "Cybereason-APT29-9814.png", "ScreenshotCaption": "18.a.2 - malicious powershell process tree with tmp file from the command line"}], "Footnotes": ["A sensor policy update that enables deeper PowerShell visibility was re-applied."]}, {"DetectionNote": "An MSSP detection for Exfiltration Over Alternative Protocol occurred containing evidence of PowerShell using Copy-Item to the Y drive.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10809.png", "ScreenshotCaption": "MSSP - a2"}]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesscheck.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Detections": [{"DetectionNote": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change (Detections)", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9912.png", "ScreenshotCaption": "6.a.1 - accesschk.exe tre (cc)"}], "Footnotes": ["A sensor policy update that enables file read event collection was re-applied."]}]}]}, {"TechniqueId": "T1099", "TechniqueName": "Timestomp", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure. However, manually viewing kxwn.lock on the impacted host showed that it had been modified, so it is identified as Host Interrogation.", "DetectionType": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9726.png", "ScreenshotCaption": "12.a.2 - lock file was created"}]}]}]}, {"TechniqueId": "T1145", "TechniqueName": "Private Keys", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Detections": [{"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9616.png", "ScreenshotCaption": "file event details with random file name from process tree"}]}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.A.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1096", "TechniqueName": "NTFS File Attributes", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9689.png", "ScreenshotCaption": "11.a.2 - commandline, schemas, etc. from process tree"}, {"ScreenshotName": "Cybereason-APT29-9687.png", "ScreenshotCaption": "11.a.1/2 - get-content "}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing\u00a0Compress-Archive", "Detections": [{"DetectionNote": "An MSSP detection for \"PowerShell activity looking for files in a directory\" occurred containing evidence of powershell.exe compressing via Compress-Archive.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10772.png", "ScreenshotCaption": "MSSP - a5 (draft.zip create)"}, {"ScreenshotName": "Cybereason-APT29-10773.png", "ScreenshotCaption": "MSSP - a2 (child item in blue box), a3 (pam file reads)"}]}]}, {"SubStep": "7.B.2", "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Detections": [{"DetectionNote": "Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9623.png", "ScreenshotCaption": "7.b.2 - office supplies.7z information from events"}]}]}, {"SubStep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9655.png", "ScreenshotCaption": "9.b.6 / 7 powershell executing rar.exe in process tree"}]}]}, {"SubStep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Detections": [{"DetectionNote": "A MSSP detection for Data Compressed occurred containing evidence of PowerShell compressing collection via ZipFile.CreateFromDirectory .NET method.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10807.png", "ScreenshotCaption": "MSSP - function zip - c1"}]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-13667.png", "ScreenshotCaption": "2b1 - draft.zip - vendor provided pic"}]}]}, {"SubStep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe\u00a0reading the file working.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "Telemetry showed python.exe reading working.zip and an existing C2 channel (192.168.0.4 over port 8443). The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-13668.png", "ScreenshotCaption": "9b8 - vendor provided pic"}]}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "A General alert detection called \"Malicious Command\" was generated for wsmprovhost.exe executing Get-Process.", "DetectionType": "General", "Modifiers": ["Configuration Change (Detections)", "Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9967.png", "ScreenshotCaption": "8.a.3 - malicious command alert - Get-Process (cc)"}], "Footnotes": ["A sensor policy update that enables deeper PowerShell visibility was re-applied."]}]}, {"SubStep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Detections": [{"DetectionNote": "An MSSP detection for \"Win32 process executing...attempting to retrieve users\" occurred containing evidence of the PowerShell gwmi query for Win32_Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10788.png", "ScreenshotCaption": "MSSP - a8 "}]}]}, {"SubStep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Detections": [{"DetectionNote": "An MSSP detection for a PowerShell process occurred containing evidence of the CreateToolhelp32Snapshot API call.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10794.png", "ScreenshotCaption": "MSSP - API call"}]}]}, {"SubStep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "An MSSP detection for \"Process Discovery\" occurred containing evidence of PowerShell Get-Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10795.png", "ScreenshotCaption": "MSSP - get process "}, {"ScreenshotName": "Cybereason-APT29-10796.png", "ScreenshotCaption": "MSSP - description of get-process"}]}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Detections": [{"DetectionNote": "An MSSP detection for \"Discovery - System Owner/User Discovery\" occurred containing evidence of PowerShell executing: $env:USERNAME.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10799.png", "ScreenshotCaption": "MSSP - c2 invoke discovery Username"}]}]}, {"SubStep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Detections": [{"DetectionNote": "An MSSP detection for a PowerShell process occurred containing evidence of the GetUserNameEx API call.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10793.png", "ScreenshotCaption": "MSSP - API call"}]}]}, {"SubStep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Detections": [{"DetectionNote": "An MSSP detection for Account Discovery occurred containing evidence of the ConvertSidToStringSid API call.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10802.png", "ScreenshotCaption": "MSSP - api call"}]}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "A General alert detection was generated for powershell.exe executing Get-ChildItem.", "DetectionType": "General", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9952.png", "ScreenshotCaption": "2.a.1/2 - get-ChildItem powershell (cc)"}], "Footnotes": ["A sensor policy update that enables deeper PowerShell visibility was re-applied."]}, {"DetectionNote": "A MSSP detection for \"PowerShell activity looking for files in a directory\" occurred containing evidence of a file event for powershell.exe executing ChildItem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10773.png", "ScreenshotCaption": "MSSP - a2 (child item in blue box), a3 (pam file reads)"}]}]}, {"SubStep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing\u00a0$env:TEMP", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "A General alert detection was generated for powershell.exe executing Get-ChildItem\u200b. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "DetectionType": "General", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-13287.png", "ScreenshotCaption": "9.b.2/3 - malware alert malicious command (cc)"}], "Footnotes": ["A sensor policy update that enables deeper PowerShell visibility was re-applied."]}]}, {"SubStep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Detections": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9603.png", "ScreenshotCaption": "4.b.2 / 3 / 4 - sdelete deleting files"}, {"ScreenshotName": "Cybereason-APT29-9601.png", "ScreenshotCaption": "4.b.2 / 3 / 4 - filenames from path"}, {"ScreenshotName": "Cybereason-APT29-9605.png", "ScreenshotCaption": "4.b.2 / 3 /4 - sdelete deleting the files"}, {"ScreenshotName": "Cybereason-APT29-9602.png", "ScreenshotCaption": "4.b.2 / 3 / 4 - sdelete 64 process tree"}]}]}, {"SubStep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Detections": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9601.png", "ScreenshotCaption": "4.b.2 / 3 / 4 - filenames from path"}, {"ScreenshotName": "Cybereason-APT29-9603.png", "ScreenshotCaption": "4.b.2 / 3 / 4 - sdelete deleting files"}, {"ScreenshotName": "Cybereason-APT29-9602.png", "ScreenshotCaption": "4.b.2 / 3 / 4 - sdelete 64 process tree"}, {"ScreenshotName": "Cybereason-APT29-9605.png", "ScreenshotCaption": "4.b.2 / 3 /4 - sdelete deleting the files"}]}]}, {"SubStep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9601.png", "ScreenshotCaption": "4.b.2 / 3 / 4 - filenames from path"}, {"ScreenshotName": "Cybereason-APT29-9603.png", "ScreenshotCaption": "4.b.2 / 3 / 4 - sdelete deleting files"}, {"ScreenshotName": "Cybereason-APT29-9602.png", "ScreenshotCaption": "4.b.2 / 3 / 4 - sdelete 64 process tree"}, {"ScreenshotName": "Cybereason-APT29-9605.png", "ScreenshotCaption": "4.b.2 / 3 /4 - sdelete deleting the files"}]}]}, {"SubStep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Detections": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9661.png", "ScreenshotCaption": "9c1 / 2 sdelete deleting the rar.exe file and working.zip file"}]}]}, {"SubStep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Detections": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9661.png", "ScreenshotCaption": "9c1 / 2 sdelete deleting the rar.exe file and working.zip file"}]}]}, {"SubStep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Detections": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9664.png", "ScreenshotCaption": "9.c.3 sdelete deleting appdata working zip file"}]}]}, {"SubStep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe deleting sdelete64.exe and file deletion event. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-13290.png", "ScreenshotCaption": "9.c.4 cmd.exe deleting the sdelete"}]}]}, {"SubStep": "19.A.1", "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\System32\\m.exe", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.1", "Procedure": "Deleted exfiltrated data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration.tmp", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.1", "Procedure": "Deleted staged data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1114", "TechniqueName": "Email Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red, unique symbol) called \"PowerShell access to Outlook mailbox data (ATT&CK: Collection)\" was generated due a process having access to Outlook mailbox data through use of a PowerShell script. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-13286.png", "ScreenshotCaption": "17.a.1 - malop powershell.exe detectied as malicious"}, {"ScreenshotName": "Cybereason-APT29-9798.png", "ScreenshotCaption": "17.a.1 - powershell access to outlook under suspicions, marked on poewrshell not outlook.exe process"}, {"ScreenshotName": "Cybereason-APT29-9797.png", "ScreenshotCaption": "17.a.1- process tree and evidence"}]}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9797.png", "ScreenshotCaption": "17.a.1- process tree and evidence"}]}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called was generated for a mismatch between the parent and creator process on PowerShell.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9675.png", "ScreenshotCaption": "10.b.2 - evidence of powershell process"}]}]}]}, {"TechniqueId": "T1140", "TechniqueName": "Deobfuscate/Decode Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Detections": [{"DetectionNote": "Telemetry showed PowerShell writing the files that were decompressed from the ZIP. The detection was correlated to a parent alert for malicious PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9599.png", "ScreenshotCaption": "4.a.3 - we have the events with the files from the expand archive "}]}]}, {"SubStep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Certutil.exe used to decode data\" was generated for certutil decoding the payload with command-line arguments.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9691.png", "ScreenshotCaption": "11.a.10 - evidence, commandline of certutil and decode"}]}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9691.png", "ScreenshotCaption": "11.a.10 - evidence, commandline of certutil and decode"}]}]}, {"SubStep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Detections": [{"DetectionNote": "An MSSP detection for \"Deobfuscate/Decode Files or Information\" occurred containing evidence of the PowerShell Get-WmiInstance reading encoded content from Win32_AuditCode.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10798.png", "ScreenshotCaption": "MSSP - auditcode, not what were testing for directly, but capturing for now"}]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby ", "Detections": [{"DetectionNote": "A Technique alert detection called \"net.exe is used to create a user or add a user to a group\" was generated for net.exe with the command-line arguments to add the new user Toby. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9849.png", "ScreenshotCaption": "20.b.3 - commandline with new user created by net.exe"}, {"ScreenshotName": "Cybereason-APT29-9848.png", "ScreenshotCaption": "20.b.3 - evidence from net.exe "}]}, {"DetectionNote": "Telemetry showed net.exe with the command-line arguments to add the new user Toby. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9849.png", "ScreenshotCaption": "20.b.3 - commandline with new user created by net.exe"}]}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Detections": [{"DetectionNote": "An MSSP detection for Data Staged occurred containing evidence of the creation of the file Draft.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10772.png", "ScreenshotCaption": "MSSP - a5 (draft.zip create)"}]}, {"DetectionNote": "Telemetry showed file creation of Draft.zip. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-7372.png", "ScreenshotCaption": "2.a.5 - file create event for draft.zip file"}]}]}, {"SubStep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Detections": [{"DetectionNote": "Telemetry showed a Create File event for powershell.exe creating working.zip. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9653.png", "ScreenshotCaption": "9.b.5 file creating with app data roaming file"}]}]}, {"SubStep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9799.png", "ScreenshotCaption": "17.b.2 - file event with the powershell process tree and html file "}]}]}]}, {"TechniqueId": "T1084", "TechniqueName": "Windows Management Instrumentation Event Subscription", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Detections": [{"DetectionNote": "An MSSP detection for \"Windows Management Instrumentation Event Subscription\" occurred containing evidence of WindowsParentalControlMigration WMI filter.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10801.png", "ScreenshotCaption": "MSSP - a2 - better pic"}]}]}, {"SubStep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Detections": [{"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9831.png", "ScreenshotCaption": "20.a.2 - process tree with wmiprvse and powershell"}]}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing\u200b Gwmi Win32_OperatingSystem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Detections": [{"DetectionNote": "A General alert detection was generated for GetComputerNameEx being executed by powershell.exe. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "General", "Modifiers": ["Configuration Change (Detections)", "Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9928.png", "ScreenshotCaption": "13.a.1 - malicious command alert for GetComputerNameEx (cc)"}], "Footnotes": ["For the Configuration Change, the PowerShell detection policy was disabled."]}, {"DetectionNote": "An MSSP detection for \"System Information Discovery\" occurred containing evidence of the GetComputerNameEx API call.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10791.png", "ScreenshotCaption": "MSSP - computername API"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scanton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Detections": [{"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135. The detection was correlated to a parent alert for malicious PowerShell. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9644.png", "ScreenshotCaption": "8.c.2 - connection on port 135"}]}]}]}, {"TechniqueId": "T1047", "TechniqueName": "Windows Management Instrumentation", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Detections": [{"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9749.png", "ScreenshotCaption": "14.b.1 - process tree with wmiprvse.exe"}]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A General alert detection (red; unique symbol) for malicious PowerShell was generated for new high integrity PowerShell callback spawning from control.exe\u200b\u200b. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-7389.png", "ScreenshotCaption": "3.b.2 - high integrity proess"}]}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-7389.png", "ScreenshotCaption": "3.b.2 - high integrity proess"}]}]}, {"SubStep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A General alert detection (red; unique symbol) was generated for \"malicious use of powershell.exe\" that showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9734.png", "ScreenshotCaption": "14.a.2 - process details"}, {"ScreenshotName": "Cybereason-APT29-9731.png", "ScreenshotCaption": "14.a.2 - powershell.exe malicious use, process tree view"}, {"ScreenshotName": "Cybereason-APT29-9733.png", "ScreenshotCaption": "14.a.2 - high integrity from behavior"}]}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9731.png", "ScreenshotCaption": "14.a.2 - powershell.exe malicious use, process tree view"}]}]}]}, {"TechniqueId": "T1027", "TechniqueName": "Obfuscated Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within\u00a0monkey.png", "Detections": [{"DetectionNote": "A General alert detection was generated for a malicious PowerShell process that showed the PowerShell script contained within monkey.png. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9894.png", "ScreenshotCaption": "3.a.2 - powershell loaded from monkey. full path from process tree"}, {"ScreenshotName": "Cybereason-APT29-9895.png", "ScreenshotCaption": "3.a.2 - malop for malicious process, powershell "}]}, {"DetectionNote": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence of the PowerShell script contained within monkey.png.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10775.png", "ScreenshotCaption": "MSSP - a2, PS in monkey"}]}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9893.png", "ScreenshotCaption": ""}]}]}, {"SubStep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Detections": [{"DetectionNote": "A General alert detection was generated for Set-WmiInstance (by suspicious process). The detection was correlated to a parent alert for the malicious use of powershell.exe. ", "DetectionType": "General", "Modifiers": ["Configuration Change (Detections)", "Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9929.png", "ScreenshotCaption": "14.b.5 - alert for the Set-WmiInstance (cc)"}], "Footnotes": ["A sensor policy update that enables deeper PowerShell visibility was re-applied."]}]}, {"SubStep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Detections": [{"DetectionNote": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence of PowerShell appending the GIF file header to the compressed file.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10808.png", "ScreenshotCaption": "MSSP - set content - c2"}, {"ScreenshotName": "Cybereason-APT29-10807.png", "ScreenshotCaption": "MSSP - function zip - c1"}]}]}]}, {"TechniqueId": "T1065", "TechniqueName": "Uncommonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Detections": [{"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-7334.png", "ScreenshotCaption": "1.a.3 - process details showing the network connection over port 1234"}]}]}]}, {"TechniqueId": "T1120", "TechniqueName": "Peripheral Device Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1119", "TechniqueName": "Automated Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "A General alert detection for \"malicious command\" was generated on powershell.exe executing Get-ChildItem.", "DetectionType": "General", "Modifiers": ["Configuration Change (Detections)", "Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-9952.png", "ScreenshotCaption": "2.a.1/2 - get-ChildItem powershell (cc)"}], "Footnotes": ["A sensor policy update that enables deeper PowerShell visibility was re-applied."]}, {"DetectionNote": "An MSSP detection for \"PowerShell activity looking for files in a directory\" occurred containing evidence of a file event and powershell.exe executing ChildItem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-10773.png", "ScreenshotCaption": "MSSP - a2 (child item in blue box), a3 (pam file reads)"}]}]}, {"SubStep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "A General alert detection for \"malicious command\" was generated on powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ", "DetectionType": "General", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Cybereason-APT29-13287.png", "ScreenshotCaption": "9.b.2/3 - malware alert malicious command (cc)"}], "Footnotes": ["A sensor policy update that enables deeper PowerShell visibility was re-applied."]}]}]}]}